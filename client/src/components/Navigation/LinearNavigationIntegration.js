/**
 * LinearNavigationIntegration - Real-world Integration Example
 * Shows how to integrate the Linear Navigation system into Nexus ChatApp
 */

import React, { useState, useEffect } from 'react';
import { 
  NavigationGuardProvider, 
  NavigationFlowManager, 
  ProgressIndicator,
  useNavigationGuard 
} from './index';
import { 
  FiMessageSquare, 
  FiUsers, 
  FiSettings, 
  FiShield,
  FiBell,
  FiUser,
  FiCheck
} from 'react-icons/fi';
import './LinearNavigationIntegration.css';

// Chat Setup Steps
const ChatWelcomeStep = () => {
  const { navigateTo, markCurrentCompleted } = useNavigationGuard();

  const handleStart = () => {
    markCurrentCompleted({ welcomeViewed: true });
    navigateTo('profile-creation');
  };

  return (
    <div className=\"integration-step chat-welcome\">\n      <div className=\"step-header\">\n        <FiMessageSquare size={48} />\n        <h2>Welcome to Nexus ChatApp</h2>\n        <p>Let's set up your chat experience in just a few steps</p>\n      </div>\n\n      <div className=\"welcome-features\">\n        <div className=\"feature-card\">\n          <FiUsers />\n          <h3>Connect with Friends</h3>\n          <p>Find and chat with people you know</p>\n        </div>\n        <div className=\"feature-card\">\n          <FiShield />\n          <h3>Secure Messaging</h3>\n          <p>End-to-end encrypted conversations</p>\n        </div>\n        <div className=\"feature-card\">\n          <FiBell />\n          <h3>Smart Notifications</h3>\n          <p>Stay updated without being overwhelmed</p>\n        </div>\n      </div>\n\n      <button className=\"primary-btn\" onClick={handleStart}>\n        Get Started\n      </button>\n    </div>\n  );\n};\n\nconst ProfileCreationStep = () => {\n  const { navigateTo, markCurrentCompleted, jumpOut } = useNavigationGuard();\n  const [profile, setProfile] = useState({\n    username: '',\n    displayName: '',\n    avatar: null,\n    status: 'online'\n  });\n  const [isValid, setIsValid] = useState(false);\n\n  useEffect(() => {\n    setIsValid(profile.username.length >= 3 && profile.displayName.length >= 2);\n  }, [profile]);\n\n  const handleInputChange = (field, value) => {\n    setProfile(prev => ({ ...prev, [field]: value }));\n  };\n\n  const handleContinue = () => {\n    if (isValid) {\n      markCurrentCompleted({ profile });\n      navigateTo('privacy-settings');\n    }\n  };\n\n  const handleAvatarHelp = () => {\n    jumpOut('avatar-help');\n  };\n\n  return (\n    <div className=\"integration-step profile-creation\">\n      <div className=\"step-header\">\n        <FiUser size={48} />\n        <h2>Create Your Profile</h2>\n        <p>How do you want others to see you?</p>\n      </div>\n\n      <div className=\"profile-form\">\n        <div className=\"avatar-section\">\n          <div className=\"avatar-preview\">\n            {profile.avatar ? (\n              <img src={profile.avatar} alt=\"Avatar\" />\n            ) : (\n              <FiUser size={32} />\n            )}\n          </div>\n          <div className=\"avatar-actions\">\n            <button className=\"secondary-btn\" onClick={handleAvatarHelp}>\n              Choose Avatar\n            </button>\n          </div>\n        </div>\n\n        <div className=\"form-fields\">\n          <div className=\"field-group\">\n            <label>Username *</label>\n            <input\n              type=\"text\"\n              value={profile.username}\n              onChange={(e) => handleInputChange('username', e.target.value)}\n              placeholder=\"@username\"\n              minLength={3}\n              required\n            />\n            <small>This is how others will find you</small>\n          </div>\n\n          <div className=\"field-group\">\n            <label>Display Name *</label>\n            <input\n              type=\"text\"\n              value={profile.displayName}\n              onChange={(e) => handleInputChange('displayName', e.target.value)}\n              placeholder=\"Your display name\"\n              minLength={2}\n              required\n            />\n            <small>This is how your name appears in chats</small>\n          </div>\n\n          <div className=\"field-group\">\n            <label>Status</label>\n            <select \n              value={profile.status}\n              onChange={(e) => handleInputChange('status', e.target.value)}\n            >\n              <option value=\"online\">ðŸŸ¢ Online</option>\n              <option value=\"away\">ðŸŸ¡ Away</option>\n              <option value=\"busy\">ðŸ”´ Busy</option>\n              <option value=\"invisible\">âš« Invisible</option>\n            </select>\n          </div>\n        </div>\n      </div>\n\n      <button \n        className=\"primary-btn\" \n        onClick={handleContinue}\n        disabled={!isValid}\n      >\n        Continue\n      </button>\n    </div>\n  );\n};\n\nconst PrivacySettingsStep = () => {\n  const { navigateTo, markCurrentCompleted } = useNavigationGuard();\n  const [privacy, setPrivacy] = useState({\n    whoCanMessage: 'everyone',\n    whoCanSeeProfile: 'friends',\n    showOnlineStatus: true,\n    readReceipts: true,\n    lastSeen: true\n  });\n\n  const handleSettingChange = (field, value) => {\n    setPrivacy(prev => ({ ...prev, [field]: value }));\n  };\n\n  const handleContinue = () => {\n    markCurrentCompleted({ privacy });\n    navigateTo('notification-setup');\n  };\n\n  return (\n    <div className=\"integration-step privacy-settings\">\n      <div className=\"step-header\">\n        <FiShield size={48} />\n        <h2>Privacy Settings</h2>\n        <p>Control who can interact with you and see your information</p>\n      </div>\n\n      <div className=\"privacy-options\">\n        <div className=\"option-group\">\n          <h3>Who can message you?</h3>\n          <div className=\"radio-group\">\n            <label>\n              <input\n                type=\"radio\"\n                name=\"whoCanMessage\"\n                value=\"everyone\"\n                checked={privacy.whoCanMessage === 'everyone'}\n                onChange={(e) => handleSettingChange('whoCanMessage', e.target.value)}\n              />\n              <span>Everyone</span>\n            </label>\n            <label>\n              <input\n                type=\"radio\"\n                name=\"whoCanMessage\"\n                value=\"friends\"\n                checked={privacy.whoCanMessage === 'friends'}\n                onChange={(e) => handleSettingChange('whoCanMessage', e.target.value)}\n              />\n              <span>Friends only</span>\n            </label>\n            <label>\n              <input\n                type=\"radio\"\n                name=\"whoCanMessage\"\n                value=\"nobody\"\n                checked={privacy.whoCanMessage === 'nobody'}\n                onChange={(e) => handleSettingChange('whoCanMessage', e.target.value)}\n              />\n              <span>Nobody</span>\n            </label>\n          </div>\n        </div>\n\n        <div className=\"option-group\">\n          <h3>Profile Visibility</h3>\n          <div className=\"radio-group\">\n            <label>\n              <input\n                type=\"radio\"\n                name=\"whoCanSeeProfile\"\n                value=\"everyone\"\n                checked={privacy.whoCanSeeProfile === 'everyone'}\n                onChange={(e) => handleSettingChange('whoCanSeeProfile', e.target.value)}\n              />\n              <span>Public</span>\n            </label>\n            <label>\n              <input\n                type=\"radio\"\n                name=\"whoCanSeeProfile\"\n                value=\"friends\"\n                checked={privacy.whoCanSeeProfile === 'friends'}\n                onChange={(e) => handleSettingChange('whoCanSeeProfile', e.target.value)}\n              />\n              <span>Friends only</span>\n            </label>\n            <label>\n              <input\n                type=\"radio\"\n                name=\"whoCanSeeProfile\"\n                value=\"private\"\n                checked={privacy.whoCanSeeProfile === 'private'}\n                onChange={(e) => handleSettingChange('whoCanSeeProfile', e.target.value)}\n              />\n              <span>Private</span>\n            </label>\n          </div>\n        </div>\n\n        <div className=\"option-group\">\n          <h3>Activity Information</h3>\n          <div className=\"toggle-group\">\n            <label className=\"toggle-label\">\n              <input\n                type=\"checkbox\"\n                checked={privacy.showOnlineStatus}\n                onChange={(e) => handleSettingChange('showOnlineStatus', e.target.checked)}\n              />\n              <span>Show online status</span>\n            </label>\n            <label className=\"toggle-label\">\n              <input\n                type=\"checkbox\"\n                checked={privacy.readReceipts}\n                onChange={(e) => handleSettingChange('readReceipts', e.target.checked)}\n              />\n              <span>Send read receipts</span>\n            </label>\n            <label className=\"toggle-label\">\n              <input\n                type=\"checkbox\"\n                checked={privacy.lastSeen}\n                onChange={(e) => handleSettingChange('lastSeen', e.target.checked)}\n              />\n              <span>Show last seen</span>\n            </label>\n          </div>\n        </div>\n      </div>\n\n      <button className=\"primary-btn\" onClick={handleContinue}>\n        Continue\n      </button>\n    </div>\n  );\n};\n\nconst NotificationSetupStep = () => {\n  const { navigateTo, markCurrentCompleted } = useNavigationGuard();\n  const [notifications, setNotifications] = useState({\n    pushEnabled: true,\n    soundEnabled: true,\n    vibrationEnabled: true,\n    messageNotifications: true,\n    groupNotifications: true,\n    mentionNotifications: true,\n    quietHours: {\n      enabled: false,\n      start: '22:00',\n      end: '08:00'\n    }\n  });\n\n  const handleNotificationChange = (field, value) => {\n    setNotifications(prev => ({ ...prev, [field]: value }));\n  };\n\n  const handleQuietHoursChange = (field, value) => {\n    setNotifications(prev => ({\n      ...prev,\n      quietHours: {\n        ...prev.quietHours,\n        [field]: value\n      }\n    }));\n  };\n\n  const handleContinue = () => {\n    markCurrentCompleted({ notifications });\n    navigateTo('setup-complete');\n  };\n\n  return (\n    <div className=\"integration-step notification-setup\">\n      <div className=\"step-header\">\n        <FiBell size={48} />\n        <h2>Notification Preferences</h2>\n        <p>Choose how you want to be notified about new messages</p>\n      </div>\n\n      <div className=\"notification-options\">\n        <div className=\"option-section\">\n          <h3>General Notifications</h3>\n          <div className=\"toggle-group\">\n            <label className=\"toggle-label\">\n              <input\n                type=\"checkbox\"\n                checked={notifications.pushEnabled}\n                onChange={(e) => handleNotificationChange('pushEnabled', e.target.checked)}\n              />\n              <span>Push notifications</span>\n            </label>\n            <label className=\"toggle-label\">\n              <input\n                type=\"checkbox\"\n                checked={notifications.soundEnabled}\n                onChange={(e) => handleNotificationChange('soundEnabled', e.target.checked)}\n              />\n              <span>Sound notifications</span>\n            </label>\n            <label className=\"toggle-label\">\n              <input\n                type=\"checkbox\"\n                checked={notifications.vibrationEnabled}\n                onChange={(e) => handleNotificationChange('vibrationEnabled', e.target.checked)}\n              />\n              <span>Vibration</span>\n            </label>\n          </div>\n        </div>\n\n        <div className=\"option-section\">\n          <h3>Message Types</h3>\n          <div className=\"toggle-group\">\n            <label className=\"toggle-label\">\n              <input\n                type=\"checkbox\"\n                checked={notifications.messageNotifications}\n                onChange={(e) => handleNotificationChange('messageNotifications', e.target.checked)}\n              />\n              <span>Direct messages</span>\n            </label>\n            <label className=\"toggle-label\">\n              <input\n                type=\"checkbox\"\n                checked={notifications.groupNotifications}\n                onChange={(e) => handleNotificationChange('groupNotifications', e.target.checked)}\n              />\n              <span>Group messages</span>\n            </label>\n            <label className=\"toggle-label\">\n              <input\n                type=\"checkbox\"\n                checked={notifications.mentionNotifications}\n                onChange={(e) => handleNotificationChange('mentionNotifications', e.target.checked)}\n              />\n              <span>Mentions only</span>\n            </label>\n          </div>\n        </div>\n\n        <div className=\"option-section\">\n          <h3>Quiet Hours</h3>\n          <label className=\"toggle-label\">\n            <input\n              type=\"checkbox\"\n              checked={notifications.quietHours.enabled}\n              onChange={(e) => handleQuietHoursChange('enabled', e.target.checked)}\n            />\n            <span>Enable quiet hours</span>\n          </label>\n          \n          {notifications.quietHours.enabled && (\n            <div className=\"quiet-hours-config\">\n              <div className=\"time-inputs\">\n                <div className=\"time-input\">\n                  <label>From</label>\n                  <input\n                    type=\"time\"\n                    value={notifications.quietHours.start}\n                    onChange={(e) => handleQuietHoursChange('start', e.target.value)}\n                  />\n                </div>\n                <div className=\"time-input\">\n                  <label>To</label>\n                  <input\n                    type=\"time\"\n                    value={notifications.quietHours.end}\n                    onChange={(e) => handleQuietHoursChange('end', e.target.value)}\n                  />\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      <button className=\"primary-btn\" onClick={handleContinue}>\n        Continue\n      </button>\n    </div>\n  );\n};\n\nconst SetupCompleteStep = () => {\n  const { getProgress, resetNavigation } = useNavigationGuard();\n  const [isLaunching, setIsLaunching] = useState(false);\n  \n  const progress = getProgress();\n\n  const handleLaunchApp = () => {\n    setIsLaunching(true);\n    // Simulate app launch\n    setTimeout(() => {\n      alert('ðŸŽ‰ Welcome to Nexus ChatApp! Your setup is complete.');\n      setIsLaunching(false);\n    }, 2000);\n  };\n\n  const handleStartOver = () => {\n    resetNavigation();\n  };\n\n  return (\n    <div className=\"integration-step setup-complete\">\n      <div className=\"step-header\">\n        <div className=\"success-icon\">\n          <FiCheck size={48} />\n        </div>\n        <h2>Setup Complete!</h2>\n        <p>Your Nexus ChatApp is ready to use</p>\n      </div>\n\n      <div className=\"completion-summary\">\n        <h3>What you've configured:</h3>\n        <div className=\"summary-items\">\n          <div className=\"summary-item\">\n            <FiUser />\n            <span>Profile created</span>\n          </div>\n          <div className=\"summary-item\">\n            <FiShield />\n            <span>Privacy settings configured</span>\n          </div>\n          <div className=\"summary-item\">\n            <FiBell />\n            <span>Notifications customized</span>\n          </div>\n        </div>\n        \n        <div className=\"progress-stats\">\n          <div className=\"stat\">\n            <span className=\"stat-number\">{progress.completed}</span>\n            <span className=\"stat-label\">Steps Completed</span>\n          </div>\n          <div className=\"stat\">\n            <span className=\"stat-number\">{progress.percentage}%</span>\n            <span className=\"stat-label\">Progress</span>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"completion-actions\">\n        <button className=\"secondary-btn\" onClick={handleStartOver}>\n          Start Over\n        </button>\n        <button \n          className=\"primary-btn launch-btn\" \n          onClick={handleLaunchApp}\n          disabled={isLaunching}\n        >\n          {isLaunching ? 'Launching...' : 'Launch Nexus ChatApp'}\n        </button>\n      </div>\n    </div>\n  );\n};\n\n// Main Integration Component\nconst LinearNavigationIntegration = ({ onComplete }) => {\n  const [isInitialized, setIsInitialized] = useState(false);\n\n  // Define the chat setup flow\n  const chatSetupRoutes = [\n    {\n      id: 'chat-welcome',\n      title: 'Welcome',\n      description: 'Welcome to Nexus ChatApp',\n      component: ChatWelcomeStep,\n      allowDirectAccess: true\n    },\n    {\n      id: 'profile-creation',\n      title: 'Create Profile',\n      description: 'Set up your chat profile',\n      component: ProfileCreationStep,\n      prerequisites: ['chat-welcome']\n    },\n    {\n      id: 'privacy-settings',\n      title: 'Privacy Settings',\n      description: 'Configure your privacy preferences',\n      component: PrivacySettingsStep,\n      prerequisites: ['profile-creation']\n    },\n    {\n      id: 'notification-setup',\n      title: 'Notifications',\n      description: 'Set up notification preferences',\n      component: NotificationSetupStep,\n      prerequisites: ['privacy-settings']\n    },\n    {\n      id: 'setup-complete',\n      title: 'Complete',\n      description: 'Setup completed successfully',\n      component: SetupCompleteStep,\n      prerequisites: ['notification-setup']\n    }\n  ];\n\n  return (\n    <div className=\"linear-navigation-integration\">\n      <NavigationGuardProvider>\n        <NavigationInitializer \n          routes={chatSetupRoutes}\n          onInitialized={() => setIsInitialized(true)}\n        />\n        \n        {isInitialized && (\n          <NavigationFlowManager\n            showProgress={true}\n            showControls={true}\n            allowSkipping={false}\n            onFlowComplete={(data) => {\n              console.log('Chat setup completed:', data);\n              onComplete?.(data);\n            }}\n            className=\"chat-setup-flow\"\n          >\n            <div className=\"integration-content\">\n              <NavigationRenderer routes={chatSetupRoutes} />\n            </div>\n          </NavigationFlowManager>\n        )}\n      </NavigationGuardProvider>\n    </div>\n  );\n};\n\n// Helper Components (same as in LinearNavigationExample)\nconst NavigationInitializer = ({ routes, onInitialized }) => {\n  const { registerGuardedRoute, navigateTo } = useNavigationGuard();\n\n  useEffect(() => {\n    routes.forEach(route => {\n      registerGuardedRoute(route.id, route);\n    });\n\n    setTimeout(() => {\n      navigateTo('chat-welcome');\n      onInitialized();\n    }, 100);\n  }, [routes, registerGuardedRoute, navigateTo, onInitialized]);\n\n  return null;\n};\n\nconst NavigationRenderer = ({ routes }) => {\n  const { currentRoute } = useNavigationGuard();\n  \n  const currentRouteConfig = routes.find(route => route.id === currentRoute);\n  const CurrentComponent = currentRouteConfig?.component;\n\n  if (!CurrentComponent) {\n    return (\n      <div className=\"no-route\">\n        <p>Loading...</p>\n      </div>\n    );\n  }\n\n  return <CurrentComponent />;\n};\n\nexport default LinearNavigationIntegration;"